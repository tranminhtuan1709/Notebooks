{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "27136ebc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:21:39.557956Z",
     "iopub.status.busy": "2025-02-02T10:21:39.557718Z",
     "iopub.status.idle": "2025-02-02T10:21:55.333077Z",
     "shell.execute_reply": "2025-02-02T10:21:55.332110Z"
    },
    "papermill": {
     "duration": 15.780121,
     "end_time": "2025-02-02T10:21:55.334523",
     "exception": false,
     "start_time": "2025-02-02T10:21:39.554402",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'spectre'...\r\n",
      "remote: Enumerating objects: 242, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (21/21), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (9/9), done.\u001b[K\r\n",
      "remote: Total 242 (delta 19), reused 12 (delta 12), pack-reused 221 (from 1)\u001b[K\r\n",
      "Receiving objects: 100% (242/242), 17.44 MiB | 33.83 MiB/s, done.\r\n",
      "Resolving deltas: 100% (120/120), done.\r\n",
      "Submodule 'external/Visual_Speech_Recognition_for_Multiple_Languages' (https://github.com/mpc001/Visual_Speech_Recognition_for_Multiple_Languages) registered for path 'external/Visual_Speech_Recognition_for_Multiple_Languages'\r\n",
      "Submodule 'external/av_hubert' (https://github.com/facebookresearch/av_hubert) registered for path 'external/av_hubert'\r\n",
      "Submodule 'external/face_alignment' (https://github.com/hhj1897/face_alignment.git) registered for path 'external/face_alignment'\r\n",
      "Submodule 'external/face_detection' (https://github.com/hhj1897/face_detection) registered for path 'external/face_detection'\r\n",
      "Cloning into '/kaggle/working/spectre/external/Visual_Speech_Recognition_for_Multiple_Languages'...\r\n",
      "remote: Enumerating objects: 277, done.        \r\n",
      "remote: Counting objects: 100% (26/26), done.        \r\n",
      "remote: Compressing objects: 100% (14/14), done.        \r\n",
      "remote: Total 277 (delta 14), reused 12 (delta 12), pack-reused 251 (from 1)        \r\n",
      "Receiving objects: 100% (277/277), 69.76 MiB | 24.50 MiB/s, done.\r\n",
      "Resolving deltas: 100% (69/69), done.\r\n",
      "Cloning into '/kaggle/working/spectre/external/av_hubert'...\r\n",
      "remote: Enumerating objects: 149, done.        \r\n",
      "remote: Counting objects: 100% (31/31), done.        \r\n",
      "remote: Compressing objects: 100% (18/18), done.        \r\n",
      "remote: Total 149 (delta 17), reused 13 (delta 13), pack-reused 118 (from 2)        \r\n",
      "Receiving objects: 100% (149/149), 4.65 MiB | 16.35 MiB/s, done.\r\n",
      "Resolving deltas: 100% (64/64), done.\r\n",
      "Cloning into '/kaggle/working/spectre/external/face_alignment'...\r\n",
      "remote: Enumerating objects: 190, done.        \r\n",
      "remote: Counting objects: 100% (32/32), done.        \r\n",
      "remote: Compressing objects: 100% (6/6), done.        \r\n",
      "remote: Total 190 (delta 27), reused 27 (delta 26), pack-reused 158 (from 1)        \r\n",
      "Receiving objects: 100% (190/190), 213.82 MiB | 36.50 MiB/s, done.\r\n",
      "Resolving deltas: 100% (84/84), done.\r\n",
      "Cloning into '/kaggle/working/spectre/external/face_detection'...\r\n",
      "remote: Enumerating objects: 300, done.        \r\n",
      "remote: Counting objects: 100% (50/50), done.        \r\n",
      "remote: Compressing objects: 100% (11/11), done.        \r\n",
      "remote: Total 300 (delta 41), reused 39 (delta 39), pack-reused 250 (from 1)        \r\n",
      "Receiving objects: 100% (300/300), 81.19 MiB | 26.33 MiB/s, done.\r\n",
      "Resolving deltas: 100% (141/141), done.\r\n",
      "Submodule path 'external/Visual_Speech_Recognition_for_Multiple_Languages': checked out '53e940ee3d4bab5e5a69276ac0a7a68047c5ab8d'\r\n",
      "Submodule path 'external/av_hubert': checked out 'cd1fd24e71b18f5c1a7203aec6ce4479a61e7e67'\r\n",
      "Submodule 'fairseq' (https://github.com/pytorch/fairseq) registered for path 'external/av_hubert/fairseq'\r\n",
      "Cloning into '/kaggle/working/spectre/external/av_hubert/fairseq'...\r\n",
      "remote: Enumerating objects: 35391, done.        \r\n",
      "remote: Counting objects: 100% (16/16), done.        \r\n",
      "remote: Compressing objects: 100% (11/11), done.        \r\n",
      "remote: Total 35391 (delta 7), reused 5 (delta 5), pack-reused 35375 (from 3)        \r\n",
      "Receiving objects: 100% (35391/35391), 25.48 MiB | 30.34 MiB/s, done.\r\n",
      "Resolving deltas: 100% (25540/25540), done.\r\n",
      "Submodule path 'external/av_hubert/fairseq': checked out 'afc77bdf4bb51453ce76f1572ef2ee6ddcda8eeb'\r\n",
      "Submodule 'fairseq/model_parallel/megatron' (https://github.com/ngoyal2707/Megatron-LM) registered for path 'external/av_hubert/fairseq/fairseq/model_parallel/megatron'\r\n",
      "Cloning into '/kaggle/working/spectre/external/av_hubert/fairseq/fairseq/model_parallel/megatron'...\r\n",
      "remote: Enumerating objects: 8394, done.        \r\n",
      "remote: Total 8394 (delta 0), reused 0 (delta 0), pack-reused 8394 (from 1)        \r\n",
      "Receiving objects: 100% (8394/8394), 2.91 MiB | 15.41 MiB/s, done.\r\n",
      "Resolving deltas: 100% (6318/6318), done.\r\n",
      "remote: Enumerating objects: 8, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (6/6), done.\u001b[K\r\n",
      "remote: Total 8 (delta 6), reused 6 (delta 6), pack-reused 2 (from 1)\u001b[K\r\n",
      "Unpacking objects: 100% (8/8), 1.85 KiB | 473.00 KiB/s, done.\r\n",
      "From https://github.com/ngoyal2707/Megatron-LM\r\n",
      " * branch            adb23324c222aad0aad89308e70302d996a5eaeb -> FETCH_HEAD\r\n",
      "Submodule path 'external/av_hubert/fairseq/fairseq/model_parallel/megatron': checked out 'adb23324c222aad0aad89308e70302d996a5eaeb'\r\n",
      "Submodule path 'external/face_alignment': checked out '9cf5494e443f26d567972f3f50f6212d65b76c01'\r\n",
      "Submodule path 'external/face_detection': checked out '71852f00b815f568f3b51f045a418ae84cbe162a'\r\n"
     ]
    }
   ],
   "source": [
    "!git clone --recurse-submodules -j4 https://github.com/filby89/spectre"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "55a585c1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:21:55.349097Z",
     "iopub.status.busy": "2025-02-02T10:21:55.348802Z",
     "iopub.status.idle": "2025-02-02T10:21:55.354566Z",
     "shell.execute_reply": "2025-02-02T10:21:55.353923Z"
    },
    "papermill": {
     "duration": 0.013908,
     "end_time": "2025-02-02T10:21:55.355667",
     "exception": false,
     "start_time": "2025-02-02T10:21:55.341759",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/working/spectre\n"
     ]
    }
   ],
   "source": [
    "%cd spectre"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c560888e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:21:55.369483Z",
     "iopub.status.busy": "2025-02-02T10:21:55.369283Z",
     "iopub.status.idle": "2025-02-02T10:21:55.483769Z",
     "shell.execute_reply": "2025-02-02T10:21:55.482825Z"
    },
    "papermill": {
     "duration": 0.122818,
     "end_time": "2025-02-02T10:21:55.485113",
     "exception": false,
     "start_time": "2025-02-02T10:21:55.362295",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/working/spectre\r\n"
     ]
    }
   ],
   "source": [
    "!pwd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "384177bd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:21:55.498923Z",
     "iopub.status.busy": "2025-02-02T10:21:55.498667Z",
     "iopub.status.idle": "2025-02-02T10:21:55.506393Z",
     "shell.execute_reply": "2025-02-02T10:21:55.505395Z"
    },
    "papermill": {
     "duration": 0.016119,
     "end_time": "2025-02-02T10:21:55.507745",
     "exception": false,
     "start_time": "2025-02-02T10:21:55.491626",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "\n",
      "username=\"minhtuan1231709@gmail.com\"\n",
      "\n",
      "password=\"TuanTuan123!@#...\"\n",
      "\n",
      "\n",
      "\n",
      "echo -e \"\n",
      "\n",
      "Downloading FLAME...\"\n",
      "\n",
      "mkdir -p data/FLAME2020/\n",
      "\n",
      "wget --post-data \"username=$username&password=$password\" 'https://download.is.tue.mpg.de/download.php?domain=flame&sfile=FLAME2020.zip&resume=1' -O './FLAME2020.zip' --no-check-certificate --continue\n",
      "\n",
      "unzip FLAME2020.zip -d data/FLAME2020/\n",
      "\n",
      "rm -rf FLAME2020.zip\n",
      "\n",
      "\n",
      "\n",
      "echo -e \"\n",
      "\n",
      "Download pretrained SPECTRE model...\"\n",
      "\n",
      "gdown --id 1vmWX6QmXGPnXTXWFgj67oHzOoOmxBh6B\n",
      "\n",
      "mkdir -p pretrained/\n",
      "\n",
      "mv spectre_model.tar pretrained/\n",
      "\n"
     ]
    }
   ],
   "source": [
    "with open('/kaggle/working/spectre/quick_install.sh', 'r') as file:\n",
    "    lines = file.readlines()\n",
    "\n",
    "lines = '''\n",
    "username=\"minhtuan1231709@gmail.com\"\n",
    "password=\"TuanTuan123!@#...\"\n",
    "\n",
    "echo -e \"\\nDownloading FLAME...\"\n",
    "mkdir -p data/FLAME2020/\n",
    "wget --post-data \"username=$username&password=$password\" 'https://download.is.tue.mpg.de/download.php?domain=flame&sfile=FLAME2020.zip&resume=1' -O './FLAME2020.zip' --no-check-certificate --continue\n",
    "unzip FLAME2020.zip -d data/FLAME2020/\n",
    "rm -rf FLAME2020.zip\n",
    "\n",
    "echo -e \"\\nDownload pretrained SPECTRE model...\"\n",
    "gdown --id 1vmWX6QmXGPnXTXWFgj67oHzOoOmxBh6B\n",
    "mkdir -p pretrained/\n",
    "mv spectre_model.tar pretrained/\n",
    "'''\n",
    "\n",
    "with open('/kaggle/working/spectre/quick_install.sh', 'w') as file:\n",
    "    file.writelines(lines)\n",
    "\n",
    "with open('/kaggle/working/spectre/quick_install.sh', 'r') as file:\n",
    "    lines = file.readlines()\n",
    "    for i in lines:\n",
    "        print(i)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "23e48442",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:21:55.521930Z",
     "iopub.status.busy": "2025-02-02T10:21:55.521680Z",
     "iopub.status.idle": "2025-02-02T10:34:22.518447Z",
     "shell.execute_reply": "2025-02-02T10:34:22.517286Z"
    },
    "papermill": {
     "duration": 747.005644,
     "end_time": "2025-02-02T10:34:22.520273",
     "exception": false,
     "start_time": "2025-02-02T10:21:55.514629",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting git+https://github.com/facebookresearch/pytorch3d.git@stable\r\n",
      "  Cloning https://github.com/facebookresearch/pytorch3d.git (to revision stable) to /tmp/pip-req-build-zrgjaauj\r\n",
      "  Running command git clone --filter=blob:none --quiet https://github.com/facebookresearch/pytorch3d.git /tmp/pip-req-build-zrgjaauj\r\n",
      "  Running command git checkout -q 75ebeeaea0908c5527e7b1e305fbc7681382db47\r\n",
      "  Resolved https://github.com/facebookresearch/pytorch3d.git to commit 75ebeeaea0908c5527e7b1e305fbc7681382db47\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Collecting iopath (from pytorch3d==0.7.8)\r\n",
      "  Downloading iopath-0.1.10.tar.gz (42 kB)\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m42.2/42.2 kB\u001b[0m \u001b[31m1.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from iopath->pytorch3d==0.7.8) (4.67.1)\r\n",
      "Requirement already satisfied: typing_extensions in /usr/local/lib/python3.10/dist-packages (from iopath->pytorch3d==0.7.8) (4.12.2)\r\n",
      "Collecting portalocker (from iopath->pytorch3d==0.7.8)\r\n",
      "  Downloading portalocker-3.1.1-py3-none-any.whl.metadata (8.6 kB)\r\n",
      "Downloading portalocker-3.1.1-py3-none-any.whl (19 kB)\r\n",
      "Building wheels for collected packages: pytorch3d, iopath\r\n",
      "  Building wheel for pytorch3d (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Created wheel for pytorch3d: filename=pytorch3d-0.7.8-cp310-cp310-linux_x86_64.whl size=59599631 sha256=79ae6a1268bc11558f337fc4bb2f066b710c3b7ed21155716bf7a6e76954ed51\r\n",
      "  Stored in directory: /tmp/pip-ephem-wheel-cache-okczevne/wheels/39/5f/20/2d3b6f3a35a60bdc0ba3c19da94340db9596637d1d1222473d\r\n",
      "  Building wheel for iopath (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Created wheel for iopath: filename=iopath-0.1.10-py3-none-any.whl size=31528 sha256=fbbe9bb2624e4c29447e60538053a27d87e1b577e4342e2eb8cf07f06b54e598\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/9a/a3/b6/ac0fcd1b4ed5cfeb3db92e6a0e476cfd48ed0df92b91080c1d\r\n",
      "Successfully built pytorch3d iopath\r\n",
      "Installing collected packages: portalocker, iopath, pytorch3d\r\n",
      "Successfully installed iopath-0.1.10 portalocker-3.1.1 pytorch3d-0.7.8\r\n"
     ]
    }
   ],
   "source": [
    "!pip install 'git+https://github.com/facebookresearch/pytorch3d.git@stable'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "dad4cedd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:34:22.537485Z",
     "iopub.status.busy": "2025-02-02T10:34:22.537221Z",
     "iopub.status.idle": "2025-02-02T10:34:27.793837Z",
     "shell.execute_reply": "2025-02-02T10:34:27.792992Z"
    },
    "papermill": {
     "duration": 5.266996,
     "end_time": "2025-02-02T10:34:27.795408",
     "exception": false,
     "start_time": "2025-02-02T10:34:22.528412",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting fvcore\r\n",
      "  Downloading fvcore-0.1.5.post20221221.tar.gz (50 kB)\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.2/50.2 kB\u001b[0m \u001b[31m2.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Requirement already satisfied: iopath in /usr/local/lib/python3.10/dist-packages (0.1.10)\r\n",
      "Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from fvcore) (1.26.4)\r\n",
      "Collecting yacs>=0.1.6 (from fvcore)\r\n",
      "  Downloading yacs-0.1.8-py3-none-any.whl.metadata (639 bytes)\r\n",
      "Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from fvcore) (6.0.2)\r\n",
      "Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from fvcore) (4.67.1)\r\n",
      "Requirement already satisfied: termcolor>=1.1 in /usr/local/lib/python3.10/dist-packages (from fvcore) (2.5.0)\r\n",
      "Requirement already satisfied: Pillow in /usr/local/lib/python3.10/dist-packages (from fvcore) (11.0.0)\r\n",
      "Requirement already satisfied: tabulate in /usr/local/lib/python3.10/dist-packages (from fvcore) (0.9.0)\r\n",
      "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from iopath) (4.12.2)\r\n",
      "Requirement already satisfied: portalocker in /usr/local/lib/python3.10/dist-packages (from iopath) (3.1.1)\r\n",
      "Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy->fvcore) (1.3.8)\r\n",
      "Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy->fvcore) (1.2.4)\r\n",
      "Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy->fvcore) (0.1.1)\r\n",
      "Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy->fvcore) (2025.0.1)\r\n",
      "Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy->fvcore) (2022.0.0)\r\n",
      "Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy->fvcore) (2.4.1)\r\n",
      "Requirement already satisfied: intel-openmp>=2024 in /usr/local/lib/python3.10/dist-packages (from mkl->numpy->fvcore) (2024.2.0)\r\n",
      "Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl->numpy->fvcore) (2022.0.0)\r\n",
      "Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*->mkl->numpy->fvcore) (1.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath->numpy->fvcore) (2024.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp>=2024->mkl->numpy->fvcore) (2024.2.0)\r\n",
      "Downloading yacs-0.1.8-py3-none-any.whl (14 kB)\r\n",
      "Building wheels for collected packages: fvcore\r\n",
      "  Building wheel for fvcore (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Created wheel for fvcore: filename=fvcore-0.1.5.post20221221-py3-none-any.whl size=61396 sha256=aecf70a0691c03ea4ce81fdb5c4bcc902c95d5d126f467c891ceb9577d458f15\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/01/c0/af/77c1cf53a1be9e42a52b48e5af2169d40ec2e89f7362489dd0\r\n",
      "Successfully built fvcore\r\n",
      "Installing collected packages: yacs, fvcore\r\n",
      "Successfully installed fvcore-0.1.5.post20221221 yacs-0.1.8\r\n"
     ]
    }
   ],
   "source": [
    "!pip install fvcore iopath"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "04a502ac",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:34:27.813682Z",
     "iopub.status.busy": "2025-02-02T10:34:27.813441Z",
     "iopub.status.idle": "2025-02-02T10:35:05.416765Z",
     "shell.execute_reply": "2025-02-02T10:35:05.415692Z"
    },
    "papermill": {
     "duration": 37.614353,
     "end_time": "2025-02-02T10:35:05.418453",
     "exception": false,
     "start_time": "2025-02-02T10:34:27.804100",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting scikit_image==0.19.3 (from -r requirements.txt (line 1))\r\n",
      "  Downloading scikit_image-0.19.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.0 kB)\r\n",
      "Collecting kornia==0.6.6 (from -r requirements.txt (line 2))\r\n",
      "  Downloading kornia-0.6.6-py2.py3-none-any.whl.metadata (12 kB)\r\n",
      "Collecting chumpy==0.70 (from -r requirements.txt (line 3))\r\n",
      "  Downloading chumpy-0.70.tar.gz (50 kB)\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.6/50.6 kB\u001b[0m \u001b[31m1.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Collecting librosa==0.9.2 (from -r requirements.txt (line 4))\r\n",
      "  Downloading librosa-0.9.2-py3-none-any.whl.metadata (8.2 kB)\r\n",
      "Collecting av==9.2.0 (from -r requirements.txt (line 5))\r\n",
      "  Downloading av-9.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)\r\n",
      "Collecting loguru==0.6.0 (from -r requirements.txt (line 6))\r\n",
      "  Downloading loguru-0.6.0-py3-none-any.whl.metadata (21 kB)\r\n",
      "Collecting tensorboard==2.9.1 (from -r requirements.txt (line 7))\r\n",
      "  Downloading tensorboard-2.9.1-py3-none-any.whl.metadata (1.9 kB)\r\n",
      "Collecting pytorch_lightning==1.5 (from -r requirements.txt (line 8))\r\n",
      "  Downloading pytorch_lightning-1.5.0-py3-none-any.whl.metadata (31 kB)\r\n",
      "Collecting opencv-python==4.6.0.66 (from -r requirements.txt (line 9))\r\n",
      "  Downloading opencv_python-4.6.0.66-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (18 kB)\r\n",
      "Collecting phonemizer==3.2.1 (from -r requirements.txt (line 10))\r\n",
      "  Downloading phonemizer-3.2.1-py3-none-any.whl.metadata (7.4 kB)\r\n",
      "Collecting jiwer==2.3.0 (from -r requirements.txt (line 11))\r\n",
      "  Downloading jiwer-2.3.0-py3-none-any.whl.metadata (10 kB)\r\n",
      "Requirement already satisfied: numpy>=1.17.0 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (1.26.4)\r\n",
      "Requirement already satisfied: scipy>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (1.13.1)\r\n",
      "Requirement already satisfied: networkx>=2.2 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (3.4.2)\r\n",
      "Requirement already satisfied: pillow!=7.1.0,!=7.1.1,!=8.3.0,>=6.1.0 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (11.0.0)\r\n",
      "Requirement already satisfied: imageio>=2.4.1 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (2.36.1)\r\n",
      "Requirement already satisfied: tifffile>=2019.7.26 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (2024.12.12)\r\n",
      "Requirement already satisfied: PyWavelets>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (1.8.0)\r\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from scikit_image==0.19.3->-r requirements.txt (line 1)) (24.2)\r\n",
      "Requirement already satisfied: torch>=1.8.1 in /usr/local/lib/python3.10/dist-packages (from kornia==0.6.6->-r requirements.txt (line 2)) (2.5.1+cu121)\r\n",
      "Requirement already satisfied: six>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from chumpy==0.70->-r requirements.txt (line 3)) (1.17.0)\r\n",
      "Requirement already satisfied: audioread>=2.1.9 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (3.0.1)\r\n",
      "Requirement already satisfied: scikit-learn>=0.19.1 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (1.2.2)\r\n",
      "Requirement already satisfied: joblib>=0.14 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (1.4.2)\r\n",
      "Requirement already satisfied: decorator>=4.0.10 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (4.4.2)\r\n",
      "Collecting resampy>=0.2.2 (from librosa==0.9.2->-r requirements.txt (line 4))\r\n",
      "  Downloading resampy-0.4.3-py3-none-any.whl.metadata (3.0 kB)\r\n",
      "Requirement already satisfied: numba>=0.45.1 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (0.60.0)\r\n",
      "Requirement already satisfied: soundfile>=0.10.2 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (0.12.1)\r\n",
      "Requirement already satisfied: pooch>=1.0 in /usr/local/lib/python3.10/dist-packages (from librosa==0.9.2->-r requirements.txt (line 4)) (1.8.2)\r\n",
      "Requirement already satisfied: absl-py>=0.4 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (1.4.0)\r\n",
      "Requirement already satisfied: grpcio>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (1.68.1)\r\n",
      "Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (2.27.0)\r\n",
      "Collecting google-auth-oauthlib<0.5,>=0.4.1 (from tensorboard==2.9.1->-r requirements.txt (line 7))\r\n",
      "  Downloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl.metadata (2.7 kB)\r\n",
      "Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (3.7)\r\n",
      "Collecting protobuf<3.20,>=3.9.2 (from tensorboard==2.9.1->-r requirements.txt (line 7))\r\n",
      "  Downloading protobuf-3.19.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (787 bytes)\r\n",
      "Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (2.32.3)\r\n",
      "Requirement already satisfied: setuptools>=41.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (75.1.0)\r\n",
      "Collecting tensorboard-data-server<0.7.0,>=0.6.0 (from tensorboard==2.9.1->-r requirements.txt (line 7))\r\n",
      "  Downloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl.metadata (1.1 kB)\r\n",
      "Collecting tensorboard-plugin-wit>=1.6.0 (from tensorboard==2.9.1->-r requirements.txt (line 7))\r\n",
      "  Downloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl.metadata (873 bytes)\r\n",
      "Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (3.1.3)\r\n",
      "Requirement already satisfied: wheel>=0.26 in /usr/local/lib/python3.10/dist-packages (from tensorboard==2.9.1->-r requirements.txt (line 7)) (0.45.1)\r\n",
      "Requirement already satisfied: future>=0.17.1 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning==1.5->-r requirements.txt (line 8)) (1.0.0)\r\n",
      "Requirement already satisfied: tqdm>=4.41.0 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning==1.5->-r requirements.txt (line 8)) (4.67.1)\r\n",
      "Requirement already satisfied: PyYAML>=5.1 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning==1.5->-r requirements.txt (line 8)) (6.0.2)\r\n",
      "Requirement already satisfied: fsspec!=2021.06.0,>=2021.05.0 in /usr/local/lib/python3.10/dist-packages (from fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (2024.9.0)\r\n",
      "Requirement already satisfied: torchmetrics>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning==1.5->-r requirements.txt (line 8)) (1.6.1)\r\n",
      "Collecting pyDeprecate==0.3.1 (from pytorch_lightning==1.5->-r requirements.txt (line 8))\r\n",
      "  Downloading pyDeprecate-0.3.1-py3-none-any.whl.metadata (10 kB)\r\n",
      "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from pytorch_lightning==1.5->-r requirements.txt (line 8)) (4.12.2)\r\n",
      "Collecting segments (from phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading segments-2.2.1-py2.py3-none-any.whl.metadata (3.3 kB)\r\n",
      "Requirement already satisfied: attrs>=18.1 in /usr/local/lib/python3.10/dist-packages (from phonemizer==3.2.1->-r requirements.txt (line 10)) (24.3.0)\r\n",
      "Collecting dlinfo (from phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading dlinfo-2.0.0-py3-none-any.whl.metadata (1.1 kB)\r\n",
      "Collecting python-Levenshtein==0.12.2 (from jiwer==2.3.0->-r requirements.txt (line 11))\r\n",
      "  Downloading python-Levenshtein-0.12.2.tar.gz (50 kB)\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.5/50.5 kB\u001b[0m \u001b[31m3.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /usr/local/lib/python3.10/dist-packages (from fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (3.11.10)\r\n",
      "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard==2.9.1->-r requirements.txt (line 7)) (5.5.0)\r\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard==2.9.1->-r requirements.txt (line 7)) (0.4.1)\r\n",
      "Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard==2.9.1->-r requirements.txt (line 7)) (4.9)\r\n",
      "Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard==2.9.1->-r requirements.txt (line 7)) (1.3.1)\r\n",
      "Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba>=0.45.1->librosa==0.9.2->-r requirements.txt (line 4)) (0.43.0)\r\n",
      "Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (1.3.8)\r\n",
      "Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (1.2.4)\r\n",
      "Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (0.1.1)\r\n",
      "Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2025.0.1)\r\n",
      "Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2022.0.0)\r\n",
      "Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2.4.1)\r\n",
      "Requirement already satisfied: platformdirs>=2.5.0 in /usr/local/lib/python3.10/dist-packages (from pooch>=1.0->librosa==0.9.2->-r requirements.txt (line 4)) (4.3.6)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard==2.9.1->-r requirements.txt (line 7)) (3.4.0)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard==2.9.1->-r requirements.txt (line 7)) (3.10)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard==2.9.1->-r requirements.txt (line 7)) (2.2.3)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorboard==2.9.1->-r requirements.txt (line 7)) (2024.12.14)\r\n",
      "Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=0.19.1->librosa==0.9.2->-r requirements.txt (line 4)) (3.5.0)\r\n",
      "Requirement already satisfied: cffi>=1.0 in /usr/local/lib/python3.10/dist-packages (from soundfile>=0.10.2->librosa==0.9.2->-r requirements.txt (line 4)) (1.17.1)\r\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.8.1->kornia==0.6.6->-r requirements.txt (line 2)) (3.16.1)\r\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.8.1->kornia==0.6.6->-r requirements.txt (line 2)) (3.1.4)\r\n",
      "Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.8.1->kornia==0.6.6->-r requirements.txt (line 2)) (1.13.1)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=1.8.1->kornia==0.6.6->-r requirements.txt (line 2)) (1.3.0)\r\n",
      "Requirement already satisfied: lightning-utilities>=0.8.0 in /usr/local/lib/python3.10/dist-packages (from torchmetrics>=0.4.1->pytorch_lightning==1.5->-r requirements.txt (line 8)) (0.11.9)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard==2.9.1->-r requirements.txt (line 7)) (3.0.2)\r\n",
      "Collecting clldutils>=1.7.3 (from segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading clldutils-3.24.1-py2.py3-none-any.whl.metadata (3.0 kB)\r\n",
      "Collecting csvw>=1.5.6 (from segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading csvw-3.5.1-py2.py3-none-any.whl.metadata (10 kB)\r\n",
      "Requirement already satisfied: regex in /usr/local/lib/python3.10/dist-packages (from segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (2024.11.6)\r\n",
      "Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (2.4.4)\r\n",
      "Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (1.3.2)\r\n",
      "Requirement already satisfied: async-timeout<6.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (4.0.3)\r\n",
      "Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (1.5.0)\r\n",
      "Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (6.1.0)\r\n",
      "Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (0.2.1)\r\n",
      "Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch_lightning==1.5->-r requirements.txt (line 8)) (1.18.3)\r\n",
      "Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.0->soundfile>=0.10.2->librosa==0.9.2->-r requirements.txt (line 4)) (2.22)\r\n",
      "Requirement already satisfied: python-dateutil in /usr/local/lib/python3.10/dist-packages (from clldutils>=1.7.3->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (2.8.2)\r\n",
      "Requirement already satisfied: tabulate>=0.7.7 in /usr/local/lib/python3.10/dist-packages (from clldutils>=1.7.3->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (0.9.0)\r\n",
      "Requirement already satisfied: colorlog in /usr/local/lib/python3.10/dist-packages (from clldutils>=1.7.3->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (6.9.0)\r\n",
      "Collecting bibtexparser>=2.0.0b4 (from clldutils>=1.7.3->segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading bibtexparser-2.0.0b8-py3-none-any.whl.metadata (5.4 kB)\r\n",
      "Collecting pylatexenc (from clldutils>=1.7.3->segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading pylatexenc-2.10.tar.gz (162 kB)\r\n",
      "\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m162.6/162.6 kB\u001b[0m \u001b[31m7.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from clldutils>=1.7.3->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (5.3.0)\r\n",
      "Collecting isodate (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading isodate-0.7.2-py3-none-any.whl.metadata (11 kB)\r\n",
      "Collecting rfc3986<2 (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading rfc3986-1.5.0-py2.py3-none-any.whl.metadata (6.5 kB)\r\n",
      "Requirement already satisfied: uritemplate>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (4.1.1)\r\n",
      "Requirement already satisfied: babel in /usr/local/lib/python3.10/dist-packages (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (2.16.0)\r\n",
      "Collecting language-tags (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading language_tags-1.2.0-py3-none-any.whl.metadata (2.1 kB)\r\n",
      "Collecting rdflib (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10))\r\n",
      "  Downloading rdflib-7.1.3-py3-none-any.whl.metadata (11 kB)\r\n",
      "Requirement already satisfied: colorama in /usr/local/lib/python3.10/dist-packages (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (0.4.6)\r\n",
      "Requirement already satisfied: jsonschema in /usr/local/lib/python3.10/dist-packages (from csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (4.23.0)\r\n",
      "Requirement already satisfied: pyasn1<0.7.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard==2.9.1->-r requirements.txt (line 7)) (0.6.1)\r\n",
      "Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard==2.9.1->-r requirements.txt (line 7)) (3.2.2)\r\n",
      "Requirement already satisfied: intel-openmp>=2024 in /usr/local/lib/python3.10/dist-packages (from mkl->numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2024.2.0)\r\n",
      "Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl->numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2022.0.0)\r\n",
      "Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*->mkl->numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (1.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath->numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2024.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp>=2024->mkl->numpy>=1.17.0->scikit_image==0.19.3->-r requirements.txt (line 1)) (2024.2.0)\r\n",
      "Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema->csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (2024.10.1)\r\n",
      "Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema->csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (0.35.1)\r\n",
      "Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema->csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (0.22.3)\r\n",
      "Requirement already satisfied: pyparsing<4,>=2.1.0 in /usr/local/lib/python3.10/dist-packages (from rdflib->csvw>=1.5.6->segments->phonemizer==3.2.1->-r requirements.txt (line 10)) (3.2.0)\r\n",
      "Downloading scikit_image-0.19.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (13.9 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m13.9/13.9 MB\u001b[0m \u001b[31m93.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading kornia-0.6.6-py2.py3-none-any.whl (517 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m517.4/517.4 kB\u001b[0m \u001b[31m33.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading librosa-0.9.2-py3-none-any.whl (214 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m214.3/214.3 kB\u001b[0m \u001b[31m17.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading av-9.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (28.8 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m28.8/28.8 MB\u001b[0m \u001b[31m63.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading loguru-0.6.0-py3-none-any.whl (58 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m4.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard-2.9.1-py3-none-any.whl (5.8 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.8/5.8 MB\u001b[0m \u001b[31m108.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading pytorch_lightning-1.5.0-py3-none-any.whl (1.0 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m54.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading opencv_python-4.6.0.66-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (60.9 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m60.9/60.9 MB\u001b[0m \u001b[31m31.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading phonemizer-3.2.1-py3-none-any.whl (90 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m90.6/90.6 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading jiwer-2.3.0-py3-none-any.whl (15 kB)\r\n",
      "Downloading pyDeprecate-0.3.1-py3-none-any.whl (10 kB)\r\n",
      "Downloading google_auth_oauthlib-0.4.6-py2.py3-none-any.whl (18 kB)\r\n",
      "Downloading protobuf-3.19.6-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.1 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.1/1.1 MB\u001b[0m \u001b[31m56.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading resampy-0.4.3-py3-none-any.whl (3.1 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.1/3.1 MB\u001b[0m \u001b[31m87.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard_data_server-0.6.1-py3-none-manylinux2010_x86_64.whl (4.9 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.9/4.9 MB\u001b[0m \u001b[31m98.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading tensorboard_plugin_wit-1.8.1-py3-none-any.whl (781 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m781.3/781.3 kB\u001b[0m \u001b[31m46.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading dlinfo-2.0.0-py3-none-any.whl (3.7 kB)\r\n",
      "Downloading segments-2.2.1-py2.py3-none-any.whl (15 kB)\r\n",
      "Downloading clldutils-3.24.1-py2.py3-none-any.whl (1.7 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m66.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading csvw-3.5.1-py2.py3-none-any.whl (59 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m59.9/59.9 kB\u001b[0m \u001b[31m3.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading bibtexparser-2.0.0b8-py3-none-any.whl (39 kB)\r\n",
      "Downloading rfc3986-1.5.0-py2.py3-none-any.whl (31 kB)\r\n",
      "Downloading isodate-0.7.2-py3-none-any.whl (22 kB)\r\n",
      "Downloading language_tags-1.2.0-py3-none-any.whl (213 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m213.4/213.4 kB\u001b[0m \u001b[31m16.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hDownloading rdflib-7.1.3-py3-none-any.whl (564 kB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m564.9/564.9 kB\u001b[0m \u001b[31m35.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hBuilding wheels for collected packages: chumpy, python-Levenshtein, pylatexenc\r\n",
      "  Building wheel for chumpy (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Created wheel for chumpy: filename=chumpy-0.70-py3-none-any.whl size=58264 sha256=87efc7a107320be7a1dca7ee303c57684ec4f7fe28ce91c0017be878fff61968\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/e0/c1/ef/29ba7be03653a29ef6f2c3e1956d6c4d8877f2b243af411db1\r\n",
      "  Building wheel for python-Levenshtein (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Created wheel for python-Levenshtein: filename=python_Levenshtein-0.12.2-cp310-cp310-linux_x86_64.whl size=159971 sha256=03afe9946e6877049dadc0de5620e21064bdc8e10db4ec43d4afcdd799f4f5cd\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/7b/c3/05/60b4747cf52e0f6b6ee52022088a4de07d755016493e86373d\r\n",
      "  Building wheel for pylatexenc (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "  Created wheel for pylatexenc: filename=pylatexenc-2.10-py3-none-any.whl size=136816 sha256=cf0c37366e99f12124ee1c8a1b46264bfe1207375d986b2301eed1311dff139b\r\n",
      "  Stored in directory: /root/.cache/pip/wheels/d3/31/8b/e09b0386afd80cfc556c00408c9aeea5c35c4d484a9c762fd5\r\n",
      "Successfully built chumpy python-Levenshtein pylatexenc\r\n",
      "Installing collected packages: tensorboard-plugin-wit, rfc3986, pylatexenc, language-tags, av, tensorboard-data-server, python-Levenshtein, pyDeprecate, protobuf, loguru, isodate, dlinfo, bibtexparser, rdflib, jiwer, clldutils, kornia, google-auth-oauthlib, csvw, segments, phonemizer, tensorboard, resampy, scikit_image, pytorch_lightning, opencv-python, librosa, chumpy\r\n",
      "  Attempting uninstall: tensorboard-data-server\r\n",
      "    Found existing installation: tensorboard-data-server 0.7.2\r\n",
      "    Uninstalling tensorboard-data-server-0.7.2:\r\n",
      "      Successfully uninstalled tensorboard-data-server-0.7.2\r\n",
      "  Attempting uninstall: protobuf\r\n",
      "    Found existing installation: protobuf 3.20.3\r\n",
      "    Uninstalling protobuf-3.20.3:\r\n",
      "      Successfully uninstalled protobuf-3.20.3\r\n",
      "  Attempting uninstall: kornia\r\n",
      "    Found existing installation: kornia 0.7.4\r\n",
      "    Uninstalling kornia-0.7.4:\r\n",
      "      Successfully uninstalled kornia-0.7.4\r\n",
      "  Attempting uninstall: google-auth-oauthlib\r\n",
      "    Found existing installation: google-auth-oauthlib 1.2.1\r\n",
      "    Uninstalling google-auth-oauthlib-1.2.1:\r\n",
      "      Successfully uninstalled google-auth-oauthlib-1.2.1\r\n",
      "  Attempting uninstall: tensorboard\r\n",
      "    Found existing installation: tensorboard 2.17.1\r\n",
      "    Uninstalling tensorboard-2.17.1:\r\n",
      "      Successfully uninstalled tensorboard-2.17.1\r\n",
      "  Attempting uninstall: scikit_image\r\n",
      "    Found existing installation: scikit-image 0.25.0\r\n",
      "    Uninstalling scikit-image-0.25.0:\r\n",
      "      Successfully uninstalled scikit-image-0.25.0\r\n",
      "  Attempting uninstall: pytorch_lightning\r\n",
      "    Found existing installation: pytorch-lightning 2.5.0.post0\r\n",
      "    Uninstalling pytorch-lightning-2.5.0.post0:\r\n",
      "      Successfully uninstalled pytorch-lightning-2.5.0.post0\r\n",
      "  Attempting uninstall: opencv-python\r\n",
      "    Found existing installation: opencv-python 4.10.0.84\r\n",
      "    Uninstalling opencv-python-4.10.0.84:\r\n",
      "      Successfully uninstalled opencv-python-4.10.0.84\r\n",
      "  Attempting uninstall: librosa\r\n",
      "    Found existing installation: librosa 0.10.2.post1\r\n",
      "    Uninstalling librosa-0.10.2.post1:\r\n",
      "      Successfully uninstalled librosa-0.10.2.post1\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "gcsfs 2024.10.0 requires fsspec==2024.10.0, but you have fsspec 2024.9.0 which is incompatible.\r\n",
      "google-ai-generativelanguage 0.6.10 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-aiplatform 1.74.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-bigquery-connection 1.17.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-bigtable 2.27.0 requires google-api-core[grpc]<3.0.0dev,>=2.16.0, but you have google-api-core 1.34.1 which is incompatible.\r\n",
      "google-cloud-bigtable 2.27.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-datastore 2.20.2 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-firestore 2.19.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-functions 1.19.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-iam 2.17.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-language 2.16.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-pubsub 2.27.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-resource-manager 1.14.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-videointelligence 2.15.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "google-cloud-vision 3.9.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "googleapis-common-protos 1.66.0 requires protobuf!=3.20.0,!=3.20.1,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0.dev0,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "grpc-google-iam-v1 0.13.1 requires protobuf!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "onnx 1.17.0 requires protobuf>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "pandas-gbq 0.25.0 requires google-api-core<3.0.0dev,>=2.10.2, but you have google-api-core 1.34.1 which is incompatible.\r\n",
      "pandas-gbq 0.25.0 requires google-auth-oauthlib>=0.7.0, but you have google-auth-oauthlib 0.4.6 which is incompatible.\r\n",
      "tensorflow 2.17.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow 2.17.1 requires tensorboard<2.18,>=2.17, but you have tensorboard 2.9.1 which is incompatible.\r\n",
      "tensorflow-datasets 4.9.7 requires protobuf>=3.20, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-decision-forests 1.10.0 requires tensorflow==2.17.0, but you have tensorflow 2.17.1 which is incompatible.\r\n",
      "tensorflow-metadata 1.13.1 requires protobuf<5,>=3.20.3, but you have protobuf 3.19.6 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[0mSuccessfully installed av-9.2.0 bibtexparser-2.0.0b8 chumpy-0.70 clldutils-3.24.1 csvw-3.5.1 dlinfo-2.0.0 google-auth-oauthlib-0.4.6 isodate-0.7.2 jiwer-2.3.0 kornia-0.6.6 language-tags-1.2.0 librosa-0.9.2 loguru-0.6.0 opencv-python-4.6.0.66 phonemizer-3.2.1 protobuf-3.19.6 pyDeprecate-0.3.1 pylatexenc-2.10 python-Levenshtein-0.12.2 pytorch_lightning-1.5.0 rdflib-7.1.3 resampy-0.4.3 rfc3986-1.5.0 scikit_image-0.19.3 segments-2.2.1 tensorboard-2.9.1 tensorboard-data-server-0.6.1 tensorboard-plugin-wit-1.8.1\r\n"
     ]
    }
   ],
   "source": [
    "!pip install -r requirements.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "553e95cb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:35:05.446764Z",
     "iopub.status.busy": "2025-02-02T10:35:05.446540Z",
     "iopub.status.idle": "2025-02-02T10:35:21.814074Z",
     "shell.execute_reply": "2025-02-02T10:35:21.812956Z"
    },
    "papermill": {
     "duration": 16.383217,
     "end_time": "2025-02-02T10:35:21.815670",
     "exception": false,
     "start_time": "2025-02-02T10:35:05.432453",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/working/spectre/external/face_alignment\n",
      "Obtaining file:///kaggle/working/spectre/external/face_alignment\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.10/dist-packages (from ibug_face_alignment==0.1.0) (1.26.4)\r\n",
      "Requirement already satisfied: torch>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from ibug_face_alignment==0.1.0) (2.5.1+cu121)\r\n",
      "Requirement already satisfied: opencv-python>=3.4.2 in /usr/local/lib/python3.10/dist-packages (from ibug_face_alignment==0.1.0) (4.6.0.66)\r\n",
      "Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_alignment==0.1.0) (1.3.8)\r\n",
      "Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_alignment==0.1.0) (1.2.4)\r\n",
      "Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_alignment==0.1.0) (0.1.1)\r\n",
      "Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_alignment==0.1.0) (2025.0.1)\r\n",
      "Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_alignment==0.1.0) (2022.0.0)\r\n",
      "Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_alignment==0.1.0) (2.4.1)\r\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_alignment==0.1.0) (3.16.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_alignment==0.1.0) (4.12.2)\r\n",
      "Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_alignment==0.1.0) (3.4.2)\r\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_alignment==0.1.0) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_alignment==0.1.0) (2024.9.0)\r\n",
      "Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_alignment==0.1.0) (1.13.1)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=1.1.0->ibug_face_alignment==0.1.0) (1.3.0)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.1.0->ibug_face_alignment==0.1.0) (3.0.2)\r\n",
      "Requirement already satisfied: intel-openmp>=2024 in /usr/local/lib/python3.10/dist-packages (from mkl->numpy>=1.16.0->ibug_face_alignment==0.1.0) (2024.2.0)\r\n",
      "Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl->numpy>=1.16.0->ibug_face_alignment==0.1.0) (2022.0.0)\r\n",
      "Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*->mkl->numpy>=1.16.0->ibug_face_alignment==0.1.0) (1.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath->numpy>=1.16.0->ibug_face_alignment==0.1.0) (2024.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp>=2024->mkl->numpy>=1.16.0->ibug_face_alignment==0.1.0) (2024.2.0)\r\n",
      "Installing collected packages: ibug_face_alignment\r\n",
      "  Running setup.py develop for ibug_face_alignment\r\n",
      "Successfully installed ibug_face_alignment-0.1.0\r\n",
      "/kaggle/working/spectre/external/face_detection\n",
      "Obtaining file:///kaggle/working/spectre/external/face_detection\r\n",
      "  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\r\n",
      "Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.10/dist-packages (from ibug_face_detection==0.1.0) (1.26.4)\r\n",
      "Requirement already satisfied: scipy>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from ibug_face_detection==0.1.0) (1.13.1)\r\n",
      "Requirement already satisfied: torch>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from ibug_face_detection==0.1.0) (2.5.1+cu121)\r\n",
      "Requirement already satisfied: torchvision>=0.3.0 in /usr/local/lib/python3.10/dist-packages (from ibug_face_detection==0.1.0) (0.20.1+cu121)\r\n",
      "Requirement already satisfied: opencv-python>=3.4.2 in /usr/local/lib/python3.10/dist-packages (from ibug_face_detection==0.1.0) (4.6.0.66)\r\n",
      "Requirement already satisfied: mkl_fft in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_detection==0.1.0) (1.3.8)\r\n",
      "Requirement already satisfied: mkl_random in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_detection==0.1.0) (1.2.4)\r\n",
      "Requirement already satisfied: mkl_umath in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_detection==0.1.0) (0.1.1)\r\n",
      "Requirement already satisfied: mkl in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_detection==0.1.0) (2025.0.1)\r\n",
      "Requirement already satisfied: tbb4py in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_detection==0.1.0) (2022.0.0)\r\n",
      "Requirement already satisfied: mkl-service in /usr/local/lib/python3.10/dist-packages (from numpy>=1.16.0->ibug_face_detection==0.1.0) (2.4.1)\r\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_detection==0.1.0) (3.16.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_detection==0.1.0) (4.12.2)\r\n",
      "Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_detection==0.1.0) (3.4.2)\r\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_detection==0.1.0) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_detection==0.1.0) (2024.9.0)\r\n",
      "Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.1.0->ibug_face_detection==0.1.0) (1.13.1)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=1.1.0->ibug_face_detection==0.1.0) (1.3.0)\r\n",
      "Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.10/dist-packages (from torchvision>=0.3.0->ibug_face_detection==0.1.0) (11.0.0)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.1.0->ibug_face_detection==0.1.0) (3.0.2)\r\n",
      "Requirement already satisfied: intel-openmp>=2024 in /usr/local/lib/python3.10/dist-packages (from mkl->numpy>=1.16.0->ibug_face_detection==0.1.0) (2024.2.0)\r\n",
      "Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.10/dist-packages (from mkl->numpy>=1.16.0->ibug_face_detection==0.1.0) (2022.0.0)\r\n",
      "Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.10/dist-packages (from tbb==2022.*->mkl->numpy>=1.16.0->ibug_face_detection==0.1.0) (1.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.10/dist-packages (from mkl_umath->numpy>=1.16.0->ibug_face_detection==0.1.0) (2024.2.0)\r\n",
      "Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.10/dist-packages (from intel-openmp>=2024->mkl->numpy>=1.16.0->ibug_face_detection==0.1.0) (2024.2.0)\r\n",
      "Installing collected packages: ibug_face_detection\r\n",
      "  Running setup.py develop for ibug_face_detection\r\n",
      "Successfully installed ibug_face_detection-0.1.0\r\n",
      "/kaggle/working/spectre\n"
     ]
    }
   ],
   "source": [
    "%cd external/face_alignment\n",
    "!pip install -e .\n",
    "%cd ../face_detection\n",
    "!git lfs pull\n",
    "!pip install -e .\n",
    "%cd ../.."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "01bd9f72",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:35:21.845262Z",
     "iopub.status.busy": "2025-02-02T10:35:21.845004Z",
     "iopub.status.idle": "2025-02-02T10:35:39.036471Z",
     "shell.execute_reply": "2025-02-02T10:35:39.035381Z"
    },
    "papermill": {
     "duration": 17.207836,
     "end_time": "2025-02-02T10:35:39.038183",
     "exception": false,
     "start_time": "2025-02-02T10:35:21.830347",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: gdown in /usr/local/lib/python3.10/dist-packages (5.2.0)\r\n",
      "Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from gdown) (4.12.3)\r\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from gdown) (3.16.1)\r\n",
      "Requirement already satisfied: requests[socks] in /usr/local/lib/python3.10/dist-packages (from gdown) (2.32.3)\r\n",
      "Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from gdown) (4.67.1)\r\n",
      "Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4->gdown) (2.6)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (3.4.0)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (3.10)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (2.2.3)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (2024.12.14)\r\n",
      "Requirement already satisfied: PySocks!=1.5.7,>=1.5.6 in /usr/local/lib/python3.10/dist-packages (from requests[socks]->gdown) (1.7.1)\r\n",
      "\r\n",
      "Downloading FLAME...\r\n",
      "--2025-02-02 10:35:25--  https://download.is.tue.mpg.de/download.php?domain=flame&sfile=FLAME2020.zip&resume=1\r\n",
      "Resolving download.is.tue.mpg.de (download.is.tue.mpg.de)... 192.124.27.139\r\n",
      "Connecting to download.is.tue.mpg.de (download.is.tue.mpg.de)|192.124.27.139|:443... connected.\r\n",
      "HTTP request sent, awaiting response... 302 Found\r\n",
      "Location: download.php?domain=flame&sfile=FLAME2020.zip&resume=1 [following]\r\n",
      "--2025-02-02 10:35:26--  https://download.is.tue.mpg.de/download.php?domain=flame&sfile=FLAME2020.zip&resume=1\r\n",
      "Reusing existing connection to download.is.tue.mpg.de:443.\r\n",
      "HTTP request sent, awaiting response... 200 OK\r\n",
      "Length: 153808252 (147M) [application/octet-stream]\r\n",
      "Saving to: ‘./FLAME2020.zip’\r\n",
      "\r\n",
      "./FLAME2020.zip     100%[===================>] 146.68M  26.7MB/s    in 6.3s    \r\n",
      "\r\n",
      "2025-02-02 10:35:32 (23.3 MB/s) - ‘./FLAME2020.zip’ saved [153808252/153808252]\r\n",
      "\r\n",
      "Archive:  FLAME2020.zip\r\n",
      "  inflating: data/FLAME2020/female_model.pkl  \r\n",
      "  inflating: data/FLAME2020/generic_model.pkl  \r\n",
      "  inflating: data/FLAME2020/male_model.pkl  \r\n",
      "  inflating: data/FLAME2020/Readme.pdf  \r\n",
      "\r\n",
      "Download pretrained SPECTRE model...\r\n",
      "/usr/local/lib/python3.10/dist-packages/gdown/__main__.py:140: FutureWarning: Option `--id` was deprecated in version 4.3.1 and will be removed in 5.0. You don't need to pass it anymore to use a file ID.\r\n",
      "  warnings.warn(\r\n",
      "Downloading...\r\n",
      "From (original): https://drive.google.com/uc?id=1vmWX6QmXGPnXTXWFgj67oHzOoOmxBh6B\r\n",
      "From (redirected): https://drive.google.com/uc?id=1vmWX6QmXGPnXTXWFgj67oHzOoOmxBh6B&confirm=t&uuid=bd11e1e2-d781-4279-bb28-eb2b7995352d\r\n",
      "To: /kaggle/working/spectre/spectre_model.tar\r\n",
      "100%|█████████████████████████████████████████| 156M/156M [00:00<00:00, 210MB/s]\r\n"
     ]
    }
   ],
   "source": [
    "!pip install gdown\n",
    "!bash quick_install.sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "7ed1519a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:35:39.072365Z",
     "iopub.status.busy": "2025-02-02T10:35:39.072111Z",
     "iopub.status.idle": "2025-02-02T10:35:46.495508Z",
     "shell.execute_reply": "2025-02-02T10:35:46.494650Z"
    },
    "papermill": {
     "duration": 7.441738,
     "end_time": "2025-02-02T10:35:46.496954",
     "exception": false,
     "start_time": "2025-02-02T10:35:39.055216",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting numpy==1.23.5\r\n",
      "  Downloading numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.3 kB)\r\n",
      "Downloading numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)\r\n",
      "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m17.1/17.1 MB\u001b[0m \u001b[31m82.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n",
      "\u001b[?25hInstalling collected packages: numpy\r\n",
      "  Attempting uninstall: numpy\r\n",
      "    Found existing installation: numpy 1.26.4\r\n",
      "    Uninstalling numpy-1.26.4:\r\n",
      "      Successfully uninstalled numpy-1.26.4\r\n",
      "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\n",
      "albucore 0.0.19 requires numpy>=1.24.4, but you have numpy 1.23.5 which is incompatible.\r\n",
      "albumentations 1.4.20 requires numpy>=1.24.4, but you have numpy 1.23.5 which is incompatible.\r\n",
      "bayesian-optimization 2.0.3 requires numpy>=1.25, but you have numpy 1.23.5 which is incompatible.\r\n",
      "bigframes 1.29.0 requires numpy>=1.24.0, but you have numpy 1.23.5 which is incompatible.\r\n",
      "chex 0.1.88 requires numpy>=1.24.1, but you have numpy 1.23.5 which is incompatible.\r\n",
      "featuretools 1.31.0 requires numpy>=1.25.0, but you have numpy 1.23.5 which is incompatible.\r\n",
      "jax 0.4.33 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\r\n",
      "jaxlib 0.4.33 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\r\n",
      "mkl-fft 1.3.8 requires numpy<1.27.0,>=1.26.4, but you have numpy 1.23.5 which is incompatible.\r\n",
      "mkl-random 1.2.4 requires numpy<1.27.0,>=1.26.4, but you have numpy 1.23.5 which is incompatible.\r\n",
      "mkl-umath 0.1.1 requires numpy<1.27.0,>=1.26.4, but you have numpy 1.23.5 which is incompatible.\r\n",
      "mlxtend 0.23.3 requires scikit-learn>=1.3.1, but you have scikit-learn 1.2.2 which is incompatible.\r\n",
      "onnx 1.17.0 requires protobuf>=3.20.2, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "pandas-gbq 0.25.0 requires google-api-core<3.0.0dev,>=2.10.2, but you have google-api-core 1.34.1 which is incompatible.\r\n",
      "pandas-gbq 0.25.0 requires google-auth-oauthlib>=0.7.0, but you have google-auth-oauthlib 0.4.6 which is incompatible.\r\n",
      "plotnine 0.14.4 requires matplotlib>=3.8.0, but you have matplotlib 3.7.5 which is incompatible.\r\n",
      "pyldavis 3.4.1 requires numpy>=1.24.2, but you have numpy 1.23.5 which is incompatible.\r\n",
      "pymc 5.19.1 requires numpy>=1.25.0, but you have numpy 1.23.5 which is incompatible.\r\n",
      "tensorflow 2.17.1 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow 2.17.1 requires tensorboard<2.18,>=2.17, but you have tensorboard 2.9.1 which is incompatible.\r\n",
      "tensorflow-datasets 4.9.7 requires protobuf>=3.20, but you have protobuf 3.19.6 which is incompatible.\r\n",
      "tensorflow-decision-forests 1.10.0 requires tensorflow==2.17.0, but you have tensorflow 2.17.1 which is incompatible.\r\n",
      "woodwork 0.31.0 requires numpy>=1.25.0, but you have numpy 1.23.5 which is incompatible.\r\n",
      "xarray 2024.11.0 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\u001b[0m\u001b[31m\r\n",
      "\u001b[0mSuccessfully installed numpy-1.23.5\r\n"
     ]
    }
   ],
   "source": [
    "!pip install numpy==1.23.5 --force-reinstall"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "4b3141d2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:35:46.531789Z",
     "iopub.status.busy": "2025-02-02T10:35:46.531559Z",
     "iopub.status.idle": "2025-02-02T10:35:46.702022Z",
     "shell.execute_reply": "2025-02-02T10:35:46.701187Z"
    },
    "papermill": {
     "duration": 0.189147,
     "end_time": "2025-02-02T10:35:46.703414",
     "exception": false,
     "start_time": "2025-02-02T10:35:46.514267",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "File copied to: /kaggle/working/hehe/my_face.mp4\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import shutil\n",
    "\n",
    "source_path = \"/kaggle/input/abcdef/cac_trang_si/my_face.mp4\"\n",
    "destination_dir = \"/kaggle/working/hehe\"\n",
    "destination_path = os.path.join(destination_dir, \"my_face.mp4\")\n",
    "\n",
    "os.makedirs(destination_dir, exist_ok=True)\n",
    "\n",
    "shutil.copy(source_path, destination_path)\n",
    "\n",
    "print(f\"File copied to: {destination_path}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "3af76d0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-02-02T10:35:46.738392Z",
     "iopub.status.busy": "2025-02-02T10:35:46.738178Z",
     "iopub.status.idle": "2025-02-02T10:36:46.871298Z",
     "shell.execute_reply": "2025-02-02T10:36:46.870182Z"
    },
    "papermill": {
     "duration": 60.152157,
     "end_time": "2025-02-02T10:36:46.872896",
     "exception": false,
     "start_time": "2025-02-02T10:35:46.720739",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\r\n",
      "  warnings.warn(\r\n",
      "/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.\r\n",
      "  warnings.warn(msg)\r\n",
      "Downloading: \"https://download.pytorch.org/models/resnet50-0676ba61.pth\" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth\r\n",
      "100%|███████████████████████████████████████| 97.8M/97.8M [00:00<00:00, 181MB/s]\r\n",
      "Downloading: \"https://github.com/pytorch/vision/zipball/v0.8.1\" to /root/.cache/torch/hub/v0.8.1.zip\r\n",
      "/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.\r\n",
      "  warnings.warn(msg)\r\n",
      "Downloading: \"https://download.pytorch.org/models/mobilenet_v2-b0353104.pth\" to /root/.cache/torch/hub/checkpoints/mobilenet_v2-b0353104.pth\r\n",
      "100%|███████████████████████████████████████| 13.6M/13.6M [00:00<00:00, 123MB/s]\r\n",
      "/kaggle/working/spectre/src/spectre.py:81: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\r\n",
      "  checkpoint = torch.load(model_path)\r\n",
      "/usr/local/lib/python3.10/dist-packages/pytorch3d/io/obj_io.py:550: UserWarning: Mtl file does not exist: /kaggle/working/spectre/data/template.mtl\r\n",
      "  warnings.warn(f\"Mtl file does not exist: {f}\")\r\n",
      "/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.\r\n",
      "  warnings.warn(msg)\r\n",
      "/kaggle/working/spectre/external/face_detection/ibug/face_detection/retina_face/retina_face_predictor.py:28: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\r\n",
      "  pretrained_dict = torch.load(model.weights, map_location=self.device)\r\n",
      "/kaggle/working/spectre/external/face_alignment/ibug/face_alignment/fan/fan_predictor.py:23: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\r\n",
      "  self.net.load_state_dict(torch.load(model.weights, map_location=self.device))\r\n",
      "Preprocessing frame 147: 100%|████████████████| 147/147 [00:22<00:00,  6.59it/s]\r\n",
      "video frames are stored in /kaggle/working/hehe/my_face\r\n",
      "/kaggle/working/spectre/demo.py:149: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\r\n",
      "  overlapping_indices = np.array(overlapping_indices)\r\n",
      "Processing frames 0 to 49\r\n",
      "/kaggle/working/spectre/src/utils/util.py:272: UserWarning: Using torch.cross without specifying the dim arg is deprecated.\r\n",
      "Please either pass the dim explicitly or simply use torch.linalg.cross.\r\n",
      "The default value of dim will change to agree with that of linalg.cross in a future release. (Triggered internally at ../aten/src/ATen/native/Cross.cpp:62.)\r\n",
      "  torch.cross(vertices_faces[:, 2] - vertices_faces[:, 1], vertices_faces[:, 0] - vertices_faces[:, 1]))\r\n",
      "Processing frames 46 to 95\r\n",
      "Processing frames 92 to 141\r\n",
      "Processing frames 138 to 150\r\n",
      "/usr/local/lib/python3.10/dist-packages/librosa/util/decorators.py:88: UserWarning: PySoundFile failed. Trying audioread instead.\r\n",
      "  return f(*args, **kwargs)\r\n",
      "\u001b[0m"
     ]
    }
   ],
   "source": [
    "!python demo.py --input /kaggle/working/hehe/my_face.mp4 --audio"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "datasetId": 6588802,
     "sourceId": 10641619,
     "sourceType": "datasetVersion"
    }
   ],
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 910.377629,
   "end_time": "2025-02-02T10:36:47.216423",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-02-02T10:21:36.838794",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
